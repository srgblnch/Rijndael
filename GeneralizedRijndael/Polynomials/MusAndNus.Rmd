Study of the $mu(z)$ and $nu(z)$ candidates Rijndael's for 8 bit word size.
=====================================================================

_This a working sheet, it is evolving and does not have conclusions_

In the standarized AES, based on the Rijndael candidate where only 3 key sizes where selected, the construction of the S-Boxes is based on the composition of two funtions. The first one, $f$ understands the bits in the cells of the state matrix as elements of a binary polynomial finite field. The second one, $g$ reinterpret the coefficients on the output of $f$ as elements of a binary polynomial finite ring.

This $g(x)$ is an affine mapping using two previously chosen polynomials $mu(z)$ and $nu(z)$:
$$ b(z) = \mu(z) \cdot a(z) + \nu(z) = (z^4+z^3+z^2+z+1) \cdot a(z) + (z^6+z^5+z+1) \;\bmod{(z^8+1)}$$

But there are many other pairs of $mu$ and $nu$ that complain the requirements. Perhaps some of them even better. Conditions from section 7.2 of the "aes proposal" from 1999:
- $mu(z)$ has a simple descritption
- $nu(z)$ doesn't produce fixed points, neither oposite fixed points.

Those 21717 pairs are stored as observations in a csv file with information about the time used in the two ways to calculate the previous mention $g$ function.

```{r}
ring8 = read.csv("20150318_111533_ring_degree_8.csv",header = TRUE,sep='\t')
muOfficial <- ring8[which(ring8$muz=='z^4+z^3+z^2+z+1'),]
official <- muOfficial[which(muOfficial$nuz=='z^6+z^5+z+1'),]
library("scatterplot3d", lib.loc="~/usr/lib/R/site-library")
```

The official $mu(z)=z^4+z^3+z^2+z+1$ and $nu(z)=z^6+z^5+z+1$ have to be highlighted to know if they are special above the others (based on this timing feature).

```{r}
summary(ring8)
summary(muOfficial)
summary(official)
```

It is unknown why $mu(z)=z^4+z^3+z^2+z+1$ was chosen above the other candidates, and the criteria to chose $nu(z)=z^6+z^5+z+1$, even it is much more precise, doesn't clarify why it between the $223$ alternatives.

How different is the time, in general between those two method? The $g$ function using product versus matrix methods:

```{r}
par(mfrow=c(1,2))
boxplot(ring8$product_mean,pch=20,xlab="Product")
points(official$product_mean,col="blue",pch=16)
boxplot(ring8$matrix_mean,pch=20,xlab="Matrix")
points(official$matrix_mean,col="red",pch=16)
```

Having those two options with the same axis, is the matrix method worst than the simple product?

```{r}
boxplot(ring8$product_mean,ring8$matrix_mean,names=c("product","matrix"))
points(official$product_mean,col="blue",x=1,pch=16)
points(official$matrix_mean,col="red",x=2,pch=16)
```

And from the set of the $223$ alternatives for a fixed $mu(z)=z^4+z^3+z^2+z+1$:

```{r}
par(mfrow=c(1,2))
boxplot(muOfficial$product_mean,pch=20,xlab="Product")
points(official$product_mean,col="blue",pch=16)
boxplot(muOfficial$matrix_mean,pch=20,xlab="Matrix")
points(official$matrix_mean,col="red",pch=16)
```

```{r}
boxplot(muOfficial$product_mean,muOfficial$matrix_mean,names=c("product","matrix"))
points(official$product_mean,col="blue",x=1,pch=16)
points(official$matrix_mean,col="red",x=2,pch=16)
```

Other plots
------------------------------------

You can also embed plots, for example:

```{r fig.width=14, fig.height=6}
par(mfrow=c(1,2))
scatterplot3d(ring8$mu,ring8$nu,ring8$product_mean,pch='.',angle=3,highlight.3d = TRUE,)
scatterplot3d(ring8$mu,ring8$nu,ring8$matrix_mean,pch='.',angle=3,highlight.3d = TRUE,)
```

The plot using the Matrix calculation, on the right, have much better times (don't forget that the scales are different and the best on the left is slower the the worst on the right), and with in those better times there is a subset in the belowest area that looks separated to the others.

```{r fig.width=14, fig.height=12}
par(mfrow=c(2,2))
plot(ring8$muz,ring8$product_mean,pch='.')
plot(ring8$muz,ring8$matrix_mean,pch='.')
plot(ring8$nuz,ring8$product_mean,pch='.')
plot(ring8$nuz,ring8$matrix_mean,pch='.')
```

To have a plot where the times can be comparable, those 4 plots can be merged in 2. Also the time has been converted from seconds to microseconds.

```{r fig.width=14, fig.height=6}
par(mfrow=c(1,2))
plot(ring8$muz,ring8$product_mean*1e6,pch='.',xlab="mu(z)",col="red",ylab="us")
legend('topright',c("Product","Matrix"),lty=1,col=c('red','green'))
par(new=TRUE)
plot(ring8$muz,ring8$matrix_mean*1e6,pch='.',col="green",axes=F)
par(new=TRUE)
plot(official$muz,official$matrix_mean*1e6,pch=16,col="blue",axes=F)
title("Distributions of the mu(z) and nu(z) candidates")
plot(ring8$nuz,ring8$product_mean*1e6,pch='.',xlab="nu(z)",col="red",ylab="us")
par(new=TRUE)
plot(ring8$nuz,ring8$matrix_mean*1e6,pch='.',col="green",axes=F)
```
